{"ast":null,"code":"/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nimport VectorContext from '../VectorContext.js';\nimport { asColorLike } from '../../colorlike.js';\nimport { compose as composeTransform, create as createTransform } from '../../transform.js';\nimport { defaultFillStyle, defaultFont, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextAlign, defaultTextBaseline } from '../canvas.js';\nimport { equals } from '../../array.js';\nimport { intersects } from '../../extent.js';\nimport { transform2D } from '../../geom/flat/transform.js';\nimport { transformGeom2D } from '../../geom/SimpleGeometry.js';\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext~VectorContext VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\nvar CanvasImmediateRenderer = /** @class */function (_super) {\n  __extends(CanvasImmediateRenderer, _super);\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {number} [opt_squaredTolerance] Optional squared tolerance for simplification.\n   * @param {import(\"../../proj.js\").TransformFunction} [opt_userTransform] Transform from user to view projection.\n   */\n  function CanvasImmediateRenderer(context, pixelRatio, extent, transform, viewRotation, opt_squaredTolerance, opt_userTransform) {\n    var _this = _super.call(this) || this;\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    _this.context_ = context;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.pixelRatio_ = pixelRatio;\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    _this.extent_ = extent;\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    _this.transform_ = transform;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.viewRotation_ = viewRotation;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.squaredTolerance_ = opt_squaredTolerance;\n    /**\n     * @private\n     * @type {import(\"../../proj.js\").TransformFunction}\n     */\n    _this.userTransform_ = opt_userTransform;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    _this.contextFillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    _this.contextStrokeState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    _this.contextTextState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    _this.fillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    _this.strokeState_ = null;\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    _this.image_ = null;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageAnchorX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageAnchorY_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageHeight_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageOpacity_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageOriginX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageOriginY_ = 0;\n    /**\n     * @private\n     * @type {boolean}\n     */\n    _this.imageRotateWithView_ = false;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageRotation_ = 0;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n    _this.imageScale_ = [0, 0];\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.imageWidth_ = 0;\n    /**\n     * @private\n     * @type {string}\n     */\n    _this.text_ = '';\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.textOffsetX_ = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.textOffsetY_ = 0;\n    /**\n     * @private\n     * @type {boolean}\n     */\n    _this.textRotateWithView_ = false;\n    /**\n     * @private\n     * @type {number}\n     */\n    _this.textRotation_ = 0;\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n    _this.textScale_ = [0, 0];\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    _this.textFillState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    _this.textStrokeState_ = null;\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    _this.textState_ = null;\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    _this.pixelCoordinates_ = [];\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    _this.tmpLocalTransform_ = createTransform();\n    return _this;\n  }\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.drawImages_ = function (flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    var context = this.context_;\n    var localTransform = this.tmpLocalTransform_;\n    var alpha = context.globalAlpha;\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n    var rotation = this.imageRotation_;\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (var i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      var x = pixelCoordinates[i] - this.imageAnchorX_;\n      var y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n      if (rotation !== 0 || this.imageScale_[0] != 1 || this.imageScale_[1] != 1) {\n        var centerX = x + this.imageAnchorX_;\n        var centerY = y + this.imageAnchorY_;\n        composeTransform(localTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n        context.setTransform.apply(context, localTransform);\n        context.translate(centerX, centerY);\n        context.scale(this.imageScale_[0], this.imageScale_[1]);\n        context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, -this.imageAnchorX_, -this.imageAnchorY_, this.imageWidth_, this.imageHeight_);\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_, this.imageWidth_, this.imageHeight_, x, y, this.imageWidth_, this.imageHeight_);\n      }\n    }\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.drawText_ = function (flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n    this.setContextTextState_(this.textState_);\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    var context = this.context_;\n    var rotation = this.textRotation_;\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (; offset < end; offset += stride) {\n      var x = pixelCoordinates[offset] + this.textOffsetX_;\n      var y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n      if (rotation !== 0 || this.textScale_[0] != 1 || this.textScale_[1] != 1) {\n        var localTransform = composeTransform(this.tmpLocalTransform_, x, y, 1, 1, rotation, -x, -y);\n        context.setTransform.apply(context, localTransform);\n        context.translate(x, y);\n        context.scale(this.textScale_[0], this.textScale_[1]);\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, 0, 0);\n        }\n        if (this.textFillState_) {\n          context.fillText(this.text_, 0, 0);\n        }\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, x, y);\n        }\n        if (this.textFillState_) {\n          context.fillText(this.text_, x, y);\n        }\n      }\n    }\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n  CanvasImmediateRenderer.prototype.moveToLineTo_ = function (flatCoordinates, offset, end, stride, close) {\n    var context = this.context_;\n    var pixelCoordinates = transform2D(flatCoordinates, offset, end, stride, this.transform_, this.pixelCoordinates_);\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    var length = pixelCoordinates.length;\n    if (close) {\n      length -= 2;\n    }\n    for (var i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n    if (close) {\n      context.closePath();\n    }\n    return end;\n  };\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  CanvasImmediateRenderer.prototype.drawRings_ = function (flatCoordinates, offset, ends, stride) {\n    for (var i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n    }\n    return offset;\n  };\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.drawCircle = function (geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      var pixelCoordinates = transformGeom2D(geometry, this.transform_, this.pixelCoordinates_);\n      var dx = pixelCoordinates[2] - pixelCoordinates[0];\n      var dy = pixelCoordinates[3] - pixelCoordinates[1];\n      var radius = Math.sqrt(dx * dx + dy * dy);\n      var context = this.context_;\n      context.beginPath();\n      context.arc(pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  };\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.setStyle = function (style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  };\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n  CanvasImmediateRenderer.prototype.setTransform = function (transform) {\n    this.transform_ = transform;\n  };\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate~CanvasImmediateRenderer#setStyle renderer.setStyle()} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.drawGeometry = function (geometry) {\n    var type = geometry.getType();\n    switch (type) {\n      case 'Point':\n        this.drawPoint(/** @type {import(\"../../geom/Point.js\").default} */geometry);\n        break;\n      case 'LineString':\n        this.drawLineString(/** @type {import(\"../../geom/LineString.js\").default} */geometry);\n        break;\n      case 'Polygon':\n        this.drawPolygon(/** @type {import(\"../../geom/Polygon.js\").default} */geometry);\n        break;\n      case 'MultiPoint':\n        this.drawMultiPoint(/** @type {import(\"../../geom/MultiPoint.js\").default} */geometry);\n        break;\n      case 'MultiLineString':\n        this.drawMultiLineString(/** @type {import(\"../../geom/MultiLineString.js\").default} */geometry);\n        break;\n      case 'MultiPolygon':\n        this.drawMultiPolygon(/** @type {import(\"../../geom/MultiPolygon.js\").default} */geometry);\n        break;\n      case 'GeometryCollection':\n        this.drawGeometryCollection(/** @type {import(\"../../geom/GeometryCollection.js\").default} */geometry);\n        break;\n      case 'Circle':\n        this.drawCircle(/** @type {import(\"../../geom/Circle.js\").default} */geometry);\n        break;\n      default:\n    }\n  };\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @api\n   */\n  CanvasImmediateRenderer.prototype.drawFeature = function (feature, style) {\n    var geometry = style.getGeometryFunction()(feature);\n    if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  };\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   */\n  CanvasImmediateRenderer.prototype.drawGeometryCollection = function (geometry) {\n    var geometries = geometry.getGeometriesArray();\n    for (var i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  };\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   */\n  CanvasImmediateRenderer.prototype.drawPoint = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Point.js\").default} */geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   */\n  CanvasImmediateRenderer.prototype.drawMultiPoint = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPoint.js\").default} */geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n    var flatCoordinates = geometry.getFlatCoordinates();\n    var stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  };\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   */\n  CanvasImmediateRenderer.prototype.drawLineString = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/LineString.js\").default} */geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length, geometry.getStride(), false);\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      var flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  };\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   */\n  CanvasImmediateRenderer.prototype.drawMultiLineString = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiLineString.js\").default} */geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n    var geometryExtent = geometry.getExtent();\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      var context = this.context_;\n      var flatCoordinates = geometry.getFlatCoordinates();\n      var offset = 0;\n      var ends = /** @type {Array<number>} */geometry.getEnds();\n      var stride = geometry.getStride();\n      context.beginPath();\n      for (var i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n      }\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      var flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  };\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   */\n  CanvasImmediateRenderer.prototype.drawPolygon = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Polygon.js\").default} */geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      var context = this.context_;\n      context.beginPath();\n      this.drawRings_(geometry.getOrientedFlatCoordinates(), 0, /** @type {Array<number>} */geometry.getEnds(), geometry.getStride());\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      var flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  };\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   */\n  CanvasImmediateRenderer.prototype.drawMultiPolygon = function (geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_);\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      var context = this.context_;\n      var flatCoordinates = geometry.getOrientedFlatCoordinates();\n      var offset = 0;\n      var endss = geometry.getEndss();\n      var stride = geometry.getStride();\n      context.beginPath();\n      for (var i = 0, ii = endss.length; i < ii; ++i) {\n        var ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      var flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.setContextFillState_ = function (fillState) {\n    var context = this.context_;\n    var contextFillState = this.contextFillState_;\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = fillState.fillStyle;\n        context.fillStyle = fillState.fillStyle;\n      }\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.setContextStrokeState_ = function (strokeState) {\n    var context = this.context_;\n    var contextStrokeState = this.contextStrokeState_;\n    if (!contextStrokeState) {\n      context.lineCap = strokeState.lineCap;\n      if (context.setLineDash) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n      context.lineJoin = strokeState.lineJoin;\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = strokeState.lineCap;\n        context.lineCap = strokeState.lineCap;\n      }\n      if (context.setLineDash) {\n        if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n          context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n        }\n        if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n          contextStrokeState.lineDashOffset = strokeState.lineDashOffset;\n          context.lineDashOffset = strokeState.lineDashOffset;\n        }\n      }\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = strokeState.lineJoin;\n        context.lineJoin = strokeState.lineJoin;\n      }\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = strokeState.lineWidth;\n        context.lineWidth = strokeState.lineWidth;\n      }\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = strokeState.miterLimit;\n        context.miterLimit = strokeState.miterLimit;\n      }\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = strokeState.strokeStyle;\n        context.strokeStyle = strokeState.strokeStyle;\n      }\n    }\n  };\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n  CanvasImmediateRenderer.prototype.setContextTextState_ = function (textState) {\n    var context = this.context_;\n    var contextTextState = this.contextTextState_;\n    var textAlign = textState.textAlign ? textState.textAlign : defaultTextAlign;\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign = /** @type {CanvasTextAlign} */textAlign;\n      context.textBaseline = /** @type {CanvasTextBaseline} */textState.textBaseline;\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = textState.font;\n        context.font = textState.font;\n      }\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign = /** @type {CanvasTextAlign} */textAlign;\n        context.textAlign = /** @type {CanvasTextAlign} */textAlign;\n      }\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline = /** @type {CanvasTextBaseline} */textState.textBaseline;\n        context.textBaseline = /** @type {CanvasTextBaseline} */textState.textBaseline;\n      }\n    }\n  };\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   */\n  CanvasImmediateRenderer.prototype.setFillStrokeStyle = function (fillStyle, strokeStyle) {\n    var _this = this;\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      var fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(fillStyleColor ? fillStyleColor : defaultFillStyle)\n      };\n    }\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      var strokeStyleColor = strokeStyle.getColor();\n      var strokeStyleLineCap = strokeStyle.getLineCap();\n      var strokeStyleLineDash = strokeStyle.getLineDash();\n      var strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      var strokeStyleLineJoin = strokeStyle.getLineJoin();\n      var strokeStyleWidth = strokeStyle.getWidth();\n      var strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      var lineDash = strokeStyleLineDash ? strokeStyleLineDash : defaultLineDash;\n      this.strokeState_ = {\n        lineCap: strokeStyleLineCap !== undefined ? strokeStyleLineCap : defaultLineCap,\n        lineDash: this.pixelRatio_ === 1 ? lineDash : lineDash.map(function (n) {\n          return n * _this.pixelRatio_;\n        }),\n        lineDashOffset: (strokeStyleLineDashOffset ? strokeStyleLineDashOffset : defaultLineDashOffset) * this.pixelRatio_,\n        lineJoin: strokeStyleLineJoin !== undefined ? strokeStyleLineJoin : defaultLineJoin,\n        lineWidth: (strokeStyleWidth !== undefined ? strokeStyleWidth : defaultLineWidth) * this.pixelRatio_,\n        miterLimit: strokeStyleMiterLimit !== undefined ? strokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(strokeStyleColor ? strokeStyleColor : defaultStrokeStyle)\n      };\n    }\n  };\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   */\n  CanvasImmediateRenderer.prototype.setImageStyle = function (imageStyle) {\n    var imageSize;\n    if (!imageStyle || !(imageSize = imageStyle.getSize())) {\n      this.image_ = null;\n      return;\n    }\n    var imageAnchor = imageStyle.getAnchor();\n    var imageOrigin = imageStyle.getOrigin();\n    this.image_ = imageStyle.getImage(this.pixelRatio_);\n    this.imageAnchorX_ = imageAnchor[0] * this.pixelRatio_;\n    this.imageAnchorY_ = imageAnchor[1] * this.pixelRatio_;\n    this.imageHeight_ = imageSize[1] * this.pixelRatio_;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScaleArray();\n    this.imageWidth_ = imageSize[0] * this.pixelRatio_;\n  };\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   */\n  CanvasImmediateRenderer.prototype.setTextStyle = function (textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      var textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        var textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(textFillStyleColor ? textFillStyleColor : defaultFillStyle)\n        };\n      }\n      var textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        var textStrokeStyleColor = textStrokeStyle.getColor();\n        var textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        var textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        var textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n        var textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        var textStrokeStyleWidth = textStrokeStyle.getWidth();\n        var textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap: textStrokeStyleLineCap !== undefined ? textStrokeStyleLineCap : defaultLineCap,\n          lineDash: textStrokeStyleLineDash ? textStrokeStyleLineDash : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset ? textStrokeStyleLineDashOffset : defaultLineDashOffset,\n          lineJoin: textStrokeStyleLineJoin !== undefined ? textStrokeStyleLineJoin : defaultLineJoin,\n          lineWidth: textStrokeStyleWidth !== undefined ? textStrokeStyleWidth : defaultLineWidth,\n          miterLimit: textStrokeStyleMiterLimit !== undefined ? textStrokeStyleMiterLimit : defaultMiterLimit,\n          strokeStyle: asColorLike(textStrokeStyleColor ? textStrokeStyleColor : defaultStrokeStyle)\n        };\n      }\n      var textFont = textStyle.getFont();\n      var textOffsetX = textStyle.getOffsetX();\n      var textOffsetY = textStyle.getOffsetY();\n      var textRotateWithView = textStyle.getRotateWithView();\n      var textRotation = textStyle.getRotation();\n      var textScale = textStyle.getScaleArray();\n      var textText = textStyle.getText();\n      var textTextAlign = textStyle.getTextAlign();\n      var textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ? textFont : defaultFont,\n        textAlign: textTextAlign !== undefined ? textTextAlign : defaultTextAlign,\n        textBaseline: textTextBaseline !== undefined ? textTextBaseline : defaultTextBaseline\n      };\n      this.text_ = textText !== undefined ? Array.isArray(textText) ? textText.reduce(function (acc, t, i) {\n        return acc += i % 2 ? ' ' : t;\n      }, '') : textText : '';\n      this.textOffsetX_ = textOffsetX !== undefined ? this.pixelRatio_ * textOffsetX : 0;\n      this.textOffsetY_ = textOffsetY !== undefined ? this.pixelRatio_ * textOffsetY : 0;\n      this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = [this.pixelRatio_ * textScale[0], this.pixelRatio_ * textScale[1]];\n    }\n  };\n  return CanvasImmediateRenderer;\n}(VectorContext);\nexport default CanvasImmediateRenderer;","map":{"version":3,"names":["VectorContext","asColorLike","compose","composeTransform","create","createTransform","defaultFillStyle","defaultFont","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultLineWidth","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","equals","intersects","transform2D","transformGeom2D","CanvasImmediateRenderer","_super","__extends","context","pixelRatio","extent","transform","viewRotation","opt_squaredTolerance","opt_userTransform","_this","call","context_","pixelRatio_","extent_","transform_","viewRotation_","squaredTolerance_","userTransform_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","image_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageWidth_","text_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","prototype","drawImages_","flatCoordinates","offset","end","stride","pixelCoordinates","localTransform","alpha","globalAlpha","rotation","i","ii","length","x","y","centerX","centerY","setTransform","apply","translate","scale","drawImage","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","moveToLineTo_","close","moveTo","lineTo","closePath","drawRings_","ends","drawCircle","geometry","getExtent","dx","dy","radius","Math","sqrt","beginPath","arc","PI","fill","stroke","getCenter","setStyle","style","setFillStrokeStyle","getFill","getStroke","setImageStyle","getImage","setTextStyle","getText","drawGeometry","type","getType","drawPoint","drawLineString","drawPolygon","drawMultiPoint","drawMultiLineString","drawMultiPolygon","drawGeometryCollection","drawFeature","feature","getGeometryFunction","geometries","getGeometriesArray","simplifyTransformed","getFlatCoordinates","getStride","flatMidpoint","getFlatMidpoint","geometryExtent","getEnds","flatMidpoints","getFlatMidpoints","getOrientedFlatCoordinates","flatInteriorPoint","getFlatInteriorPoint","endss","getEndss","flatInteriorPoints","getFlatInteriorPoints","fillState","contextFillState","fillStyle","strokeState","contextStrokeState","lineCap","setLineDash","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","strokeStyle","textState","contextTextState","textAlign","font","textBaseline","fillStyleColor","getColor","strokeStyleColor","strokeStyleLineCap","getLineCap","strokeStyleLineDash","getLineDash","strokeStyleLineDashOffset","getLineDashOffset","strokeStyleLineJoin","getLineJoin","strokeStyleWidth","getWidth","strokeStyleMiterLimit","getMiterLimit","undefined","map","n","imageStyle","imageSize","getSize","imageAnchor","getAnchor","imageOrigin","getOrigin","getOpacity","getRotateWithView","getRotation","getScaleArray","textStyle","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","getFont","textOffsetX","getOffsetX","textOffsetY","getOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","getTextAlign","textTextBaseline","getTextBaseline","Array","isArray","reduce","acc","t"],"sources":["C:\\Users\\ncarl\\Desktop\\sketch\\openlayers-react-map\\node_modules\\ol\\src\\render\\canvas\\Immediate.js"],"sourcesContent":["/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport VectorContext from '../VectorContext.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {\n  compose as composeTransform,\n  create as createTransform,\n} from '../../transform.js';\nimport {\n  defaultFillStyle,\n  defaultFont,\n  defaultLineCap,\n  defaultLineDash,\n  defaultLineDashOffset,\n  defaultLineJoin,\n  defaultLineWidth,\n  defaultMiterLimit,\n  defaultStrokeStyle,\n  defaultTextAlign,\n  defaultTextBaseline,\n} from '../canvas.js';\nimport {equals} from '../../array.js';\nimport {intersects} from '../../extent.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext~VectorContext VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\nclass CanvasImmediateRenderer extends VectorContext {\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {number} [opt_squaredTolerance] Optional squared tolerance for simplification.\n   * @param {import(\"../../proj.js\").TransformFunction} [opt_userTransform] Transform from user to view projection.\n   */\n  constructor(\n    context,\n    pixelRatio,\n    extent,\n    transform,\n    viewRotation,\n    opt_squaredTolerance,\n    opt_userTransform\n  ) {\n    super();\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = context;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.extent_ = extent;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.transform_ = transform;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.viewRotation_ = viewRotation;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.squaredTolerance_ = opt_squaredTolerance;\n\n    /**\n     * @private\n     * @type {import(\"../../proj.js\").TransformFunction}\n     */\n    this.userTransform_ = opt_userTransform;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.contextFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.contextStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.contextTextState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.fillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.strokeState_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorY_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageHeight_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOpacity_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.imageRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageRotation_ = 0;\n\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n    this.imageScale_ = [0, 0];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageWidth_ = 0;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.text_ = '';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.textRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textRotation_ = 0;\n\n    /**\n     * @private\n     * @type {import(\"../../size.js\").Size}\n     */\n    this.textScale_ = [0, 0];\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.textFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.textStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.textState_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.pixelCoordinates_ = [];\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tmpLocalTransform_ = createTransform();\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  drawImages_(flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n    const pixelCoordinates = transform2D(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      this.transform_,\n      this.pixelCoordinates_\n    );\n    const context = this.context_;\n    const localTransform = this.tmpLocalTransform_;\n    const alpha = context.globalAlpha;\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n    let rotation = this.imageRotation_;\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (let i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      const x = pixelCoordinates[i] - this.imageAnchorX_;\n      const y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n      if (\n        rotation !== 0 ||\n        this.imageScale_[0] != 1 ||\n        this.imageScale_[1] != 1\n      ) {\n        const centerX = x + this.imageAnchorX_;\n        const centerY = y + this.imageAnchorY_;\n        composeTransform(\n          localTransform,\n          centerX,\n          centerY,\n          1,\n          1,\n          rotation,\n          -centerX,\n          -centerY\n        );\n        context.setTransform.apply(context, localTransform);\n        context.translate(centerX, centerY);\n        context.scale(this.imageScale_[0], this.imageScale_[1]);\n        context.drawImage(\n          this.image_,\n          this.imageOriginX_,\n          this.imageOriginY_,\n          this.imageWidth_,\n          this.imageHeight_,\n          -this.imageAnchorX_,\n          -this.imageAnchorY_,\n          this.imageWidth_,\n          this.imageHeight_\n        );\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        context.drawImage(\n          this.image_,\n          this.imageOriginX_,\n          this.imageOriginY_,\n          this.imageWidth_,\n          this.imageHeight_,\n          x,\n          y,\n          this.imageWidth_,\n          this.imageHeight_\n        );\n      }\n    }\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  drawText_(flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n    this.setContextTextState_(this.textState_);\n    const pixelCoordinates = transform2D(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      this.transform_,\n      this.pixelCoordinates_\n    );\n    const context = this.context_;\n    let rotation = this.textRotation_;\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (; offset < end; offset += stride) {\n      const x = pixelCoordinates[offset] + this.textOffsetX_;\n      const y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n      if (\n        rotation !== 0 ||\n        this.textScale_[0] != 1 ||\n        this.textScale_[1] != 1\n      ) {\n        const localTransform = composeTransform(\n          this.tmpLocalTransform_,\n          x,\n          y,\n          1,\n          1,\n          rotation,\n          -x,\n          -y\n        );\n        context.setTransform.apply(context, localTransform);\n        context.translate(x, y);\n        context.scale(this.textScale_[0], this.textScale_[1]);\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, 0, 0);\n        }\n        if (this.textFillState_) {\n          context.fillText(this.text_, 0, 0);\n        }\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      } else {\n        if (this.textStrokeState_) {\n          context.strokeText(this.text_, x, y);\n        }\n        if (this.textFillState_) {\n          context.fillText(this.text_, x, y);\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n  moveToLineTo_(flatCoordinates, offset, end, stride, close) {\n    const context = this.context_;\n    const pixelCoordinates = transform2D(\n      flatCoordinates,\n      offset,\n      end,\n      stride,\n      this.transform_,\n      this.pixelCoordinates_\n    );\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    let length = pixelCoordinates.length;\n    if (close) {\n      length -= 2;\n    }\n    for (let i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n    if (close) {\n      context.closePath();\n    }\n    return end;\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  drawRings_(flatCoordinates, offset, ends, stride) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(\n        flatCoordinates,\n        offset,\n        ends[i],\n        stride,\n        true\n      );\n    }\n    return offset;\n  }\n\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @api\n   */\n  drawCircle(geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const pixelCoordinates = transformGeom2D(\n        geometry,\n        this.transform_,\n        this.pixelCoordinates_\n      );\n      const dx = pixelCoordinates[2] - pixelCoordinates[0];\n      const dy = pixelCoordinates[3] - pixelCoordinates[1];\n      const radius = Math.sqrt(dx * dx + dy * dy);\n      const context = this.context_;\n      context.beginPath();\n      context.arc(\n        pixelCoordinates[0],\n        pixelCoordinates[1],\n        radius,\n        0,\n        2 * Math.PI\n      );\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  }\n\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @api\n   */\n  setStyle(style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  }\n\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n  setTransform(transform) {\n    this.transform_ = transform;\n  }\n\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate~CanvasImmediateRenderer#setStyle renderer.setStyle()} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @api\n   */\n  drawGeometry(geometry) {\n    const type = geometry.getType();\n    switch (type) {\n      case 'Point':\n        this.drawPoint(\n          /** @type {import(\"../../geom/Point.js\").default} */ (geometry)\n        );\n        break;\n      case 'LineString':\n        this.drawLineString(\n          /** @type {import(\"../../geom/LineString.js\").default} */ (geometry)\n        );\n        break;\n      case 'Polygon':\n        this.drawPolygon(\n          /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry)\n        );\n        break;\n      case 'MultiPoint':\n        this.drawMultiPoint(\n          /** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry)\n        );\n        break;\n      case 'MultiLineString':\n        this.drawMultiLineString(\n          /** @type {import(\"../../geom/MultiLineString.js\").default} */ (\n            geometry\n          )\n        );\n        break;\n      case 'MultiPolygon':\n        this.drawMultiPolygon(\n          /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry)\n        );\n        break;\n      case 'GeometryCollection':\n        this.drawGeometryCollection(\n          /** @type {import(\"../../geom/GeometryCollection.js\").default} */ (\n            geometry\n          )\n        );\n        break;\n      case 'Circle':\n        this.drawCircle(\n          /** @type {import(\"../../geom/Circle.js\").default} */ (geometry)\n        );\n        break;\n      default:\n    }\n  }\n\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @api\n   */\n  drawFeature(feature, style) {\n    const geometry = style.getGeometryFunction()(feature);\n    if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  }\n\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   */\n  drawGeometryCollection(geometry) {\n    const geometries = geometry.getGeometriesArray();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  }\n\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   */\n  drawPoint(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Point.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_\n        )\n      );\n    }\n    const flatCoordinates = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  }\n\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   */\n  drawMultiPoint(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPoint.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_\n        )\n      );\n    }\n    const flatCoordinates = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  }\n\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   */\n  drawLineString(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/LineString.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      const context = this.context_;\n      const flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(\n        flatCoordinates,\n        0,\n        flatCoordinates.length,\n        geometry.getStride(),\n        false\n      );\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      const flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  }\n\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   */\n  drawMultiLineString(geometry) {\n    if (this.squaredTolerance_) {\n      geometry =\n        /** @type {import(\"../../geom/MultiLineString.js\").default} */ (\n          geometry.simplifyTransformed(\n            this.squaredTolerance_,\n            this.userTransform_\n          )\n        );\n    }\n    const geometryExtent = geometry.getExtent();\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      const context = this.context_;\n      const flatCoordinates = geometry.getFlatCoordinates();\n      let offset = 0;\n      const ends = /** @type {Array<number>} */ (geometry.getEnds());\n      const stride = geometry.getStride();\n      context.beginPath();\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(\n          flatCoordinates,\n          offset,\n          ends[i],\n          stride,\n          false\n        );\n      }\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      const flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  }\n\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   */\n  drawPolygon(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Polygon.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const context = this.context_;\n      context.beginPath();\n      this.drawRings_(\n        geometry.getOrientedFlatCoordinates(),\n        0,\n        /** @type {Array<number>} */ (geometry.getEnds()),\n        geometry.getStride()\n      );\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      const flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  }\n\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   */\n  drawMultiPolygon(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (\n        geometry.simplifyTransformed(\n          this.squaredTolerance_,\n          this.userTransform_\n        )\n      );\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const context = this.context_;\n      const flatCoordinates = geometry.getOrientedFlatCoordinates();\n      let offset = 0;\n      const endss = geometry.getEndss();\n      const stride = geometry.getStride();\n      context.beginPath();\n      for (let i = 0, ii = endss.length; i < ii; ++i) {\n        const ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      const flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n  setContextFillState_(fillState) {\n    const context = this.context_;\n    const contextFillState = this.contextFillState_;\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle,\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = fillState.fillStyle;\n        context.fillStyle = fillState.fillStyle;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n  setContextStrokeState_(strokeState) {\n    const context = this.context_;\n    const contextStrokeState = this.contextStrokeState_;\n    if (!contextStrokeState) {\n      context.lineCap = strokeState.lineCap;\n      if (context.setLineDash) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n      context.lineJoin = strokeState.lineJoin;\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle,\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = strokeState.lineCap;\n        context.lineCap = strokeState.lineCap;\n      }\n      if (context.setLineDash) {\n        if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n          context.setLineDash(\n            (contextStrokeState.lineDash = strokeState.lineDash)\n          );\n        }\n        if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n          contextStrokeState.lineDashOffset = strokeState.lineDashOffset;\n          context.lineDashOffset = strokeState.lineDashOffset;\n        }\n      }\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = strokeState.lineJoin;\n        context.lineJoin = strokeState.lineJoin;\n      }\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = strokeState.lineWidth;\n        context.lineWidth = strokeState.lineWidth;\n      }\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = strokeState.miterLimit;\n        context.miterLimit = strokeState.miterLimit;\n      }\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = strokeState.strokeStyle;\n        context.strokeStyle = strokeState.strokeStyle;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n  setContextTextState_(textState) {\n    const context = this.context_;\n    const contextTextState = this.contextTextState_;\n    const textAlign = textState.textAlign\n      ? textState.textAlign\n      : defaultTextAlign;\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n      context.textBaseline = /** @type {CanvasTextBaseline} */ (\n        textState.textBaseline\n      );\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline,\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = textState.font;\n        context.font = textState.font;\n      }\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n        context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n      }\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline = /** @type {CanvasTextBaseline} */ (\n          textState.textBaseline\n        );\n        context.textBaseline = /** @type {CanvasTextBaseline} */ (\n          textState.textBaseline\n        );\n      }\n    }\n  }\n\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      const fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(\n          fillStyleColor ? fillStyleColor : defaultFillStyle\n        ),\n      };\n    }\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      const strokeStyleColor = strokeStyle.getColor();\n      const strokeStyleLineCap = strokeStyle.getLineCap();\n      const strokeStyleLineDash = strokeStyle.getLineDash();\n      const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      const strokeStyleLineJoin = strokeStyle.getLineJoin();\n      const strokeStyleWidth = strokeStyle.getWidth();\n      const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      const lineDash = strokeStyleLineDash\n        ? strokeStyleLineDash\n        : defaultLineDash;\n      this.strokeState_ = {\n        lineCap:\n          strokeStyleLineCap !== undefined\n            ? strokeStyleLineCap\n            : defaultLineCap,\n        lineDash:\n          this.pixelRatio_ === 1\n            ? lineDash\n            : lineDash.map((n) => n * this.pixelRatio_),\n        lineDashOffset:\n          (strokeStyleLineDashOffset\n            ? strokeStyleLineDashOffset\n            : defaultLineDashOffset) * this.pixelRatio_,\n        lineJoin:\n          strokeStyleLineJoin !== undefined\n            ? strokeStyleLineJoin\n            : defaultLineJoin,\n        lineWidth:\n          (strokeStyleWidth !== undefined\n            ? strokeStyleWidth\n            : defaultLineWidth) * this.pixelRatio_,\n        miterLimit:\n          strokeStyleMiterLimit !== undefined\n            ? strokeStyleMiterLimit\n            : defaultMiterLimit,\n        strokeStyle: asColorLike(\n          strokeStyleColor ? strokeStyleColor : defaultStrokeStyle\n        ),\n      };\n    }\n  }\n\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   */\n  setImageStyle(imageStyle) {\n    let imageSize;\n    if (!imageStyle || !(imageSize = imageStyle.getSize())) {\n      this.image_ = null;\n      return;\n    }\n    const imageAnchor = imageStyle.getAnchor();\n    const imageOrigin = imageStyle.getOrigin();\n    this.image_ = imageStyle.getImage(this.pixelRatio_);\n    this.imageAnchorX_ = imageAnchor[0] * this.pixelRatio_;\n    this.imageAnchorY_ = imageAnchor[1] * this.pixelRatio_;\n    this.imageHeight_ = imageSize[1] * this.pixelRatio_;\n    this.imageOpacity_ = imageStyle.getOpacity();\n    this.imageOriginX_ = imageOrigin[0];\n    this.imageOriginY_ = imageOrigin[1];\n    this.imageRotateWithView_ = imageStyle.getRotateWithView();\n    this.imageRotation_ = imageStyle.getRotation();\n    this.imageScale_ = imageStyle.getScaleArray();\n    this.imageWidth_ = imageSize[0] * this.pixelRatio_;\n  }\n\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   */\n  setTextStyle(textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      const textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        const textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(\n            textFillStyleColor ? textFillStyleColor : defaultFillStyle\n          ),\n        };\n      }\n      const textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        const textStrokeStyleColor = textStrokeStyle.getColor();\n        const textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        const textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        const textStrokeStyleLineDashOffset =\n          textStrokeStyle.getLineDashOffset();\n        const textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        const textStrokeStyleWidth = textStrokeStyle.getWidth();\n        const textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap:\n            textStrokeStyleLineCap !== undefined\n              ? textStrokeStyleLineCap\n              : defaultLineCap,\n          lineDash: textStrokeStyleLineDash\n            ? textStrokeStyleLineDash\n            : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset\n            ? textStrokeStyleLineDashOffset\n            : defaultLineDashOffset,\n          lineJoin:\n            textStrokeStyleLineJoin !== undefined\n              ? textStrokeStyleLineJoin\n              : defaultLineJoin,\n          lineWidth:\n            textStrokeStyleWidth !== undefined\n              ? textStrokeStyleWidth\n              : defaultLineWidth,\n          miterLimit:\n            textStrokeStyleMiterLimit !== undefined\n              ? textStrokeStyleMiterLimit\n              : defaultMiterLimit,\n          strokeStyle: asColorLike(\n            textStrokeStyleColor ? textStrokeStyleColor : defaultStrokeStyle\n          ),\n        };\n      }\n      const textFont = textStyle.getFont();\n      const textOffsetX = textStyle.getOffsetX();\n      const textOffsetY = textStyle.getOffsetY();\n      const textRotateWithView = textStyle.getRotateWithView();\n      const textRotation = textStyle.getRotation();\n      const textScale = textStyle.getScaleArray();\n      const textText = textStyle.getText();\n      const textTextAlign = textStyle.getTextAlign();\n      const textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ? textFont : defaultFont,\n        textAlign:\n          textTextAlign !== undefined ? textTextAlign : defaultTextAlign,\n        textBaseline:\n          textTextBaseline !== undefined\n            ? textTextBaseline\n            : defaultTextBaseline,\n      };\n      this.text_ =\n        textText !== undefined\n          ? Array.isArray(textText)\n            ? textText.reduce((acc, t, i) => (acc += i % 2 ? ' ' : t), '')\n            : textText\n          : '';\n      this.textOffsetX_ =\n        textOffsetX !== undefined ? this.pixelRatio_ * textOffsetX : 0;\n      this.textOffsetY_ =\n        textOffsetY !== undefined ? this.pixelRatio_ * textOffsetY : 0;\n      this.textRotateWithView_ =\n        textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = [\n        this.pixelRatio_ * textScale[0],\n        this.pixelRatio_ * textScale[1],\n      ];\n    }\n  }\n}\n\nexport default CanvasImmediateRenderer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}